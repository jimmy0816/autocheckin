# ğŸ”§ ä¾èµ–é—®é¢˜ä¿®å¤è¯´æ˜

## é—®é¢˜æè¿°
Dockeræ„å»ºæ—¶å‡ºç°npm cié”™è¯¯ï¼ŒåŸå› æ˜¯ï¼š
- å°† `puppeteer-core` æ›¿æ¢ä¸º `puppeteer` å
- `package-lock.json` æ–‡ä»¶æ²¡æœ‰æ›´æ–°
- å¯¼è‡´ä¾èµ–ä¸åŒæ­¥

## ä¿®å¤æ–¹æ¡ˆ

### 1. åˆ é™¤æ—§çš„package-lock.json
```bash
rm package-lock.json
```

### 2. æ›´æ–°Dockerfile
- ä¸å†å¤åˆ¶ `package-lock.json`
- ä½¿ç”¨ `npm install --only=production --no-package-lock`
- è®©npmè‡ªåŠ¨å¤„ç†ä¾èµ–ç‰ˆæœ¬

### 3. ä¿®æ”¹åçš„Dockerfile
```dockerfile
# å¤åˆ¶ package.json
COPY package.json ./

# å®‰è£…ä¾èµ–ï¼ˆä¸å¤åˆ¶package-lock.jsonï¼Œè®©npmè‡ªåŠ¨å¤„ç†ï¼‰
RUN npm install --only=production --no-package-lock
```

## éƒ¨ç½²æ–¹æ³•

### æ–¹æ³•1ï¼šä½¿ç”¨ä¿®å¤åçš„Dockerfile
ç›´æ¥ä½¿ç”¨æ›´æ–°åçš„Dockerfileæ„å»ºï¼š
```bash
docker build -t autocheckin .
```

### æ–¹æ³•2ï¼šæœ¬åœ°é‡æ–°ç”Ÿæˆpackage-lock.json
å¦‚æœéœ€è¦æœ¬åœ°å¼€å‘ï¼š
```bash
npm install
```

### æ–¹æ³•3ï¼šä½¿ç”¨Cloud Build
ä½¿ç”¨ `cloudbuild.complete.yaml` é…ç½®æ–‡ä»¶

## éªŒè¯ä¿®å¤

### 1. æœ¬åœ°æµ‹è¯•
```bash
node test-deps.js
```

### 2. Dockeræµ‹è¯•
```bash
docker build -t autocheckin .
docker run --rm autocheckin node test-deps.js
```

## æ³¨æ„äº‹é¡¹

1. **ç”Ÿäº§ç¯å¢ƒ**ï¼š
   - ä½¿ç”¨ `--no-package-lock` è®©npmè‡ªåŠ¨å¤„ç†ä¾èµ–
   - é¿å…ç‰ˆæœ¬é”å®šé—®é¢˜

2. **å¼€å‘ç¯å¢ƒ**ï¼š
   - å¯ä»¥è¿è¡Œ `npm install` ç”Ÿæˆæ–°çš„package-lock.json
   - ç”¨äºæœ¬åœ°å¼€å‘å’Œæµ‹è¯•

3. **ä¾èµ–ç®¡ç†**ï¼š
   - puppeteerä¼šè‡ªåŠ¨ä¸‹è½½å’Œç®¡ç†Chrome
   - ä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®šChromeè·¯å¾„

## ä¸‹ä¸€æ­¥

1. æäº¤ä¿®å¤åçš„ä»£ç 
2. é‡æ–°éƒ¨ç½²åˆ°Cloud Run
3. éªŒè¯åº”ç”¨åŠŸèƒ½æ­£å¸¸ 